# File Processing Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────────┐
│                        CLIENT APPLICATION                            │
│                     (ATSController / CLI)                            │
└────────────────────────────┬────────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────────┐
│                   FileProcessingPipeline                             │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │  Stage 1: Validation                                           │ │
│  │  ├─ FileMetadataExtractor.validateFile()                       │ │
│  │  └─ FileTypeDetector.detectFileType()                          │ │
│  └────────────────────────────────────────────────────────────────┘ │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │  Stage 2: Processor Selection                                  │ │
│  │  ├─ FileProcessorFactory.getProcessor()                        │ │
│  │  └─ FileProcessor.supports()                                   │ │
│  └────────────────────────────────────────────────────────────────┘ │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │  Stage 3: Processing                                           │ │
│  │  ├─ SpreadsheetProcessor.processFile()                         │ │
│  │  ├─ PDFProcessor.processFile()                                 │ │
│  │  └─ WordProcessor.processFile()                                │ │
│  └────────────────────────────────────────────────────────────────┘ │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │  Stage 4: Completion                                           │ │
│  │  ├─ ProcessingProgressListener.onCompleted()                   │ │
│  │  └─ ProcessingContext.setStatus(COMPLETED)                     │ │
│  └────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
                             │
         ┌───────────────────┼───────────────────┐
         │                   │                   │
         ▼                   ▼                   ▼
┌─────────────────┐  ┌──────────────┐  ┌──────────────────┐
│ProcessingContext│  │  DataRows    │  │ProcessingResult  │
│  - status       │  │  (List)      │  │  - context       │
│  - errors       │  │              │  │  - data          │
│  - metadata     │  │              │  │  - isSuccess()   │
│  - progress     │  │              │  │                  │
└─────────────────┘  └──────────────┘  └──────────────────┘

═══════════════════════════════════════════════════════════════════════

CORE INTERFACES & IMPLEMENTATIONS:

┌──────────────────────────────────────────────────────────────┐
│                     «interface»                              │
│                     FileProcessor                            │
│  ──────────────────────────────────────────────────────────  │
│  + processFile(File, Set<String>): List<DataRow>            │
│  + supports(File): boolean                                   │
│  + getProcessorName(): String                                │
│  + validateFile(File): void                                  │
└────────┬────────────────┬────────────────┬──────────────────┘
         │                │                │
         │                │                │
         ▼                ▼                ▼
┌─────────────────┐ ┌─────────────┐ ┌────────────────┐
│ Spreadsheet     │ │    PDF      │ │     Word       │
│   Processor     │ │  Processor  │ │   Processor    │
│ ─────────────── │ │ ─────────── │ │ ────────────── │
│ .xlsx, .xls     │ │   .pdf      │ │ .docx, .doc    │
└─────────────────┘ └─────────────┘ └────────────────┘

═══════════════════════════════════════════════════════════════════════

SUPPORTING COMPONENTS:

┌────────────────────────────────────────────────────────────────────┐
│  FileTypeDetector                                                  │
│  ─────────────────────────────────────────────────────────────     │
│  • Magic number detection (file signatures)                        │
│  • Extension-based fallback                                        │
│  • isSpreadsheet(), isPDF(), isWordDocument()                      │
└────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────┐
│  FileMetadataExtractor                                             │
│  ─────────────────────────────────────────────────────────────     │
│  • extractMetadata() - name, size, type, permissions               │
│  • validateFile() - comprehensive validation                       │
│  • summarizeFiles() - batch file analysis                          │
└────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────┐
│  ProcessingErrorHandler                                            │
│  ─────────────────────────────────────────────────────────────     │
│  • Error recovery strategies: FAIL_FAST, SKIP, RETRY, CONTINUE     │
│  • Error listeners                                                 │
│  • Recoverable error detection                                     │
└────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────┐
│  FileProcessorFactory (Singleton)                                  │
│  ─────────────────────────────────────────────────────────────     │
│  • Processor registration and management                           │
│  • Automatic processor selection                                   │
│  • canProcess() - file type checking                               │
└────────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════

CONCURRENT PROCESSING FLOW:

    ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
    │  File 1  │  │  File 2  │  │  File 3  │  │  File N  │
    └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
         │             │             │             │
         └─────────────┴─────────────┴─────────────┘
                       │
                       ▼
         ┌─────────────────────────────┐
         │   ThreadPoolExecutor        │
         │   (Configurable size)       │
         └─────────────────────────────┘
                       │
         ┌─────────────┼─────────────┐
         │             │             │
         ▼             ▼             ▼
    ┌────────┐   ┌────────┐   ┌────────┐
    │Worker 1│   │Worker 2│   │Worker N│
    │Pipeline│   │Pipeline│   │Pipeline│
    └───┬────┘   └───┬────┘   └───┬────┘
        │            │            │
        └────────────┴────────────┘
                     │
                     ▼
         ┌───────────────────────┐
         │  Processing Results   │
         │  (ConcurrentList)     │
         └───────────────────────┘

═══════════════════════════════════════════════════════════════════════
```
